Antwerp Mooring Fee
-------------------

Use injected variables first. Only consult the invoice when a value is missing; if still absent, state it.
Return a numbered, human-readable breakdown and the final amount. If a billed amount is known, show the variance and mark Pass/Fail at ±2%.

Inputs
------
- loa_m = {{loa_m}}
- service_time = {{service_time}}
- location = {{location}}
- delay_minutes = {{delay_minutes}}
- is_second_call = {{is_second_call}}
- is_short_movement = {{is_short_movement}}
- is_cancelled = {{is_cancelled}}
- invoice_amount (optional)

Steps
1. Base tariff by LOA:
   - Find the row where LOA_m is between "from" and "to" in MOORING_TARIFFS.
   - If LOA_m > 400: extra_segments = ceil((LOA_m-400)/5);
     Base += extra_segments × 184 (FRACTION_RATES["mooring"]).
2. Time supplement (choose one):
   - Sunday → +50% of Base
   - Night (19:00–07:00) → +25% of Base
   - Otherwise 0
3. Location supplement: +30% of Base if Location contains "riverquay".
4. Delay supplement:
   - If DelayMinutes > 45:
       HoursDelayed = ceil((DelayMinutes-45)/60)
       DelaySuppl = (Base + TimeSuppl + LocSuppl) × 0.50 × HoursDelayed
   - Else 0
5. Reductions:
   - −25% of Base if IsSecondCall
   - −50% of Base if IsShortMovement
6. Cancellation fee: Base × 0.50 if IsCancelled else 0
7. Total = Base + TimeSuppl + LocSuppl + DelaySuppl + CancelFee − Reductions
8. Validate against invoice if provided.

MOORING_TARIFFS (EUR):
[
    (0, 80.00, 190),
    (80.01, 90.00, 245),
    (90.01, 100.00, 252),
    (100.01, 110.00, 338),
    (110.01, 120.00, 350),
    (120.01, 130.00, 398),
    (130.01, 138.00, 418),
    (138.01, 146.00, 445),
    (146.01, 152.00, 499),
    (152.01, 157.00, 571),
    (157.01, 160.00, 588),
    (160.01, 167.50, 624),
    (167.51, 175.00, 774),
    (175.01, 182.50, 854),
    (182.51, 190.00, 909),
    (190.01, 197.50, 949),
    (197.51, 205.00, 1003),
    (205.01, 212.50, 1028),
    (212.51, 220.00, 1102),
    (220.01, 227.50, 1155),
    (227.51, 235.00, 1330),
    (235.01, 242.50, 1482),
    (242.51, 250.00, 1544),
    (250.01, 257.50, 1594),
    (257.51, 265.00, 1661),
    (265.01, 272.50, 1720),
    (272.51, 280.00, 1769),
    (280.01, 287.50, 1828),
    (287.51, 295.00, 1956),
    (295.01, 302.50, 2257),
    (302.51, 310.00, 2364),
    (310.01, 317.50, 2581),
    (317.51, 325.00, 2795),
    (325.01, 330.00, 3137),
    (330.01, 335.00, 3482),
    (335.01, 340.00, 3822),
    (340.01, 345.00, 3991),
    (345.01, 350.00, 4143),
    (350.01, 355.00, 4178),
    (355.01, 360.00, 4371),
    (360.01, 365.00, 4559),
    (365.01, 370.00, 4749),
    (370.01, 375.00, 4933),
    (375.01, 380.00, 5118),
    (380.01, 385.00, 5302),
    (385.01, 390.00, 5483),
    (390.01, 395.00, 5669),
    (395.01, 400.00, 5852)
]
Fraction rate beyond 400m: 184 EUR per 5m.
