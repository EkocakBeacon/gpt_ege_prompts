Antwerp Unmooring Fee
---------------------

Use injected values first; consult the invoice only if a value is missing, and note if still absent.
Return a numbered, human-readable breakdown and the final amount. If a billed amount exists, show the variance and Pass/Fail at ±2%.

Inputs
------
- loa_m = {{loa_m}}
- service_time = {{service_time}}
- location = {{location}}
- delay_minutes = {{delay_minutes}}
- is_second_call = {{is_second_call}}
- is_cancelled = {{is_cancelled}}
- invoice_amount (optional)

Steps
1. Base by LOA:
   - Pick the row where LOA_m lies within [from, to] in UNMOORING_TARIFFS.
   - If LOA_m > 400: extra_segments = ceil((LOA_m-400)/5);
     Base += extra_segments × 109 (FRACTION_RATES["unmooring"]).
2. Time supplement (choose one):
   - Sunday → +50% of Base
   - Night (19:00–07:00) → +25% of Base
   - Otherwise 0
3. Location supplement: +30% of Base if Location contains "riverquay".
4. Delay supplement:
   - If DelayMinutes > 45:
       HoursDelayed = ceil((DelayMinutes-45)/60)
       DelaySuppl = (Base + TimeSuppl + LocSuppl) × 0.50 × HoursDelayed
   - Else 0
5. Reductions: −25% of Base if IsSecondCall
6. Cancellation fee: Base × 0.50 if IsCancelled else 0
7. Total = Base + TimeSuppl + LocSuppl + DelaySuppl + CancelFee − Reductions
8. Validate against invoice if provided.

UNMOORING_TARIFFS (EUR):
[
(0, 80.00, 113),
(80.01, 90.00, 147),
(90.01, 100.00, 151),
(100.01, 110.00, 203),
(110.01, 120.00, 211),
(120.01, 130.00, 239),
(130.01, 138.00, 252),
(138.01, 146.00, 267),
(146.01, 152.00, 298),
(152.01, 157.00, 343),
(157.01, 160.00, 353),
(160.01, 167.50, 375),
(167.51, 175.00, 466),
(175.01, 182.50, 514),
(182.51, 190.00, 545),
(190.01, 197.50, 570),
(197.51, 205.00, 601),
(205.01, 212.50, 616),
(212.51, 220.00, 661),
(220.01, 227.50, 694),
(227.51, 235.00, 799),
(235.01, 242.50, 889),
(242.51, 250.00, 926),
(250.01, 257.50, 959),
(257.51, 265.00, 995),
(265.01, 272.50, 1030),
(272.51, 280.00, 1063),
(280.01, 287.50, 1096),
(287.51, 295.00, 1175),
(295.01, 302.50, 1357),
(302.51, 310.00, 1417),
(310.01, 317.50, 1549),
(317.51, 325.00, 1678),
(325.01, 330.00, 1883),
(330.01, 335.00, 2088),
(335.01, 340.00, 2295),
(340.01, 345.00, 2395),
(345.01, 350.00, 2485),
(350.01, 355.00, 2510),
(355.01, 360.00, 2621),
(360.01, 365.00, 2737),
(365.01, 370.00, 2849),
(370.01, 375.00, 2959),
(375.01, 380.00, 3069),
(380.01, 385.00, 3181),
(385.01, 390.00, 3290),
(390.01, 395.00, 3401),
(395.01, 400.00, 3510)
]

Note: Beyond 400.00 m, add €109 per additional 5.00 m (or fraction) for unmooring.
