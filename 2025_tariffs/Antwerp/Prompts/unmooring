1) Base by LOA:
   - Find the band where LOA_m ∈ [from, to] in UNMOORING_TARIFFS (see table).
   - Base = that tariff.
   - If LOA_m > 400:
       extra_segments = ceil((LOA_m - 400) / 5)
       Base += extra_segments × 109   # FRACTION_RATES["unmooring"] = 109

2) Time supplement (mutually exclusive):
   - If Sunday (weekday = 6): TimeSuppl = Base × 0.50
   - Else if hour ≥ 19 or < 7: TimeSuppl = Base × 0.25
   - Else: TimeSuppl = 0

3) Location supplement:
   - If "riverquay" in Location (case-insensitive): LocSuppl = Base × 0.30
   - Else: 0

4) Delay supplement:
   - If DelayMinutes > 45:
       HoursDelayed = ceil((DelayMinutes - 45)/60)
       DelaySuppl = (Base + TimeSuppl + LocSuppl) × 0.50 × HoursDelayed
   - Else: 0

5) Reductions:
   - Reductions = 0
   - If IsSecondCall: Reductions += Base × 0.25
   - If IsShortMovement: Reductions += Base × 0.50

6) Cancellation:
   - CancelFee = Base × 0.50 if IsCancelled else 0

7) Final amount:
   - Total = Base + TimeSuppl + LocSuppl + DelaySuppl + CancelFee - Reductions
   - FinalAmountEUR = round(Total, 2)

8) Validation:
   - Accept if |FinalAmountEUR - BilledAmountEUR| / FinalAmountEUR ≤ 0.02
   - Else, fail with a brief reason (wrong LOA band, night/Sunday not applied, riverquay, delay, reductions, cancellation).

CHECK THE INVOICE. THERE are certain things that we cannot capture without the invoice such as Extra Boatmen or Extra Motorboat. Those should directly be added from the invoice itself. If it is under Unmooring services, also add them to your final answer.

UNMOORING_TARIFFS (EUR):
[
  (0, 80.00, 113),(80.01, 90.00, 147),(90.01,100.00,151),(100.01,110.00,203),
  (110.01,120.00,211),(120.01,130.00,241),(130.01,138.00,253),(138.01,146.00,268),
  (146.01,152.00,300),(152.01,157.00,342),(157.01,160.00,353),(160.01,167.50,375),
  (167.51,175.00,466),(175.01,182.50,513),(182.51,190.00,546),(190.01,197.50,570),
  (197.51,205.00,609),(205.01,212.50,624),(212.51,220.00,668),(220.01,227.50,701),
  (227.51,235.00,807),(235.01,242.50,899),(242.51,250.00,938),(250.01,257.50,968),
  (257.51,265.00,1008),(265.01,272.50,1044),(272.51,280.00,1072),(280.01,287.50,1111),
  (287.51,295.00,1188),(295.01,302.50,1369),(302.51,310.00,1434),(310.01,317.50,1585),
  (317.51,325.00,1717),(325.01,330.00,1927),(330.01,335.00,2136),(335.01,340.00,2344),
  (340.01,345.00,2446),(345.01,350.00,2542),(350.01,355.00,2563),(355.01,360.00,2682),
  (360.01,365.00,2795),(365.01,370.00,2909),(370.01,375.00,3017),(375.01,380.00,3126),
  (380.01,385.00,3235),(385.01,390.00,3341),(390.01,395.00,3450),(395.01,400.00,3559)
]

Constants:
- Night window: 19:00–07:00 → +25%
- Sunday: +50% (overrides night)
- FRACTION_RATES["unmooring"] = 109 EUR per 5m beyond 400m
