The vessel has the following particulars:
Name: {{{vessel.name}}}
LOA: {{{vessel.particulars.loa}}}
Beam: {{{vessel.particulars.boa}}}
GT: {{{vessel.particulars.grossTonnage}}}
Reduced GT: {{{vessel.particulars.reducedGrossTonnage}}}
Net Tonnage (NT): {{{vessel.particulars.netTonnage}}}
NRT: {{{vessel.nrt}}}
Summer Deadweight: {{{vessel.summerDwt}}}
Winter Deadweight: {{{vessel.winterDwt}}}
Length between perpendiculars: {{{vessel.particulars.lbp}}}
Type: {{{vessel.type}}}
ESI score: {{{vessel.esiScore}}}
Green Award score: {{{vessel.greenAward}}}

Port call data:
Draft in: {{{portCall.prospects.currentProspects.arrival.details.draftAft}}}
Draft out: {{{portCall.prospects.currentProspects.departureDraftAft}}}
Tugs in: {{{portCall.prospects.currentProspects.arrival.details.tugs}}}
Tugs out: {{{portCall.prospects.currentProspects.departure.details.tugs}}}
Cargoes:
{{#portCall.prospects.currentProspects.terminals}}
{{#cargoes}}
* {{cargo.operation.label}} {{cargo.quantity}} {{cargo.quantityMetricLabel}} of {{cargo.cargo.name}}
{{/cargoes}}
{{/portCall.prospects.currentProspects.terminals}}

Terminal names: 
{{#portCall.prospects.currentProspects.terminals}}
{{#terminal}}
*{{name}}
{{/terminal}}
{{/portCall.prospects.currentProspects.terminals}}

Local arrival time: {{{portCall.ata}}}
Local berthing time: {{{portCall.atb}}}
Local completion of cargo operation time: {{{portCall.atc}}}
Local departure time: {{{portCall.atd}}}

The amount that was invoiced to the vessel was: {{{line.currency}}} {{{line.localAmount}}}. It was for {{{line.line.name}}}.

The invoice image(s) are attached.  
Calculation instructions: {{{lineInstructions}}}

Antwerp Compulsory Waste Fee
---------------------------

Use the constants and inputs injected above. Only check the invoice if any value is missing; if still missing, capture it in brackets with units.
Return a numbered, human-readable breakdown and the final fee. Do not apply other surcharges or discounts.

Constants
- FIXED_WASTE_FEE_EUR = {{{fixed_fee_eur}}}
- WASTE_TARIFF_PER_GT_EUR = {{{tariff_per_gt_eur}}}
- SHORT_VOYAGE_DISCOUNT_RATE = 0.05

Inputs
- GT = {{{vessel.particulars.grossTonnage}}}
- ISO14001Certified = {{{vessel.iso14001}}}
- IsShortVoyage = {{{voyage.shortVoyage}}}
- InvoiceAmountExclVAT (optional)

Steps
1. VariableFee = GT × WASTE_TARIFF_PER_GT_EUR
2. InitialFee = FIXED_WASTE_FEE_EUR + VariableFee
3. ISO discount = 10% of InitialFee if ISO14001Certified
4. Short-voyage discount = 5% of InitialFee if IsShortVoyage
5. TotalFee = InitialFee − ISO discount − Short-voyage discount
6. Round TotalFee to 2 decimals
7. If invoice amount provided: variance = |TotalFee − Invoice| / TotalFee and flag Pass/Fail at ±2%

Output
- TotalFee in EUR
- Numbered breakdown of each step
- Invoice variance and Pass/Fail if invoice amount supplied
