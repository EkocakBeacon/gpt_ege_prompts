The vessel has the following particulars:
Name: {{{vessel.name}}}
LOA: {{{vessel.particulars.loa}}}
Beam: {{{vessel.particulars.boa}}}
GT: {{{vessel.particulars.grossTonnage}}}
Reduced GT: {{{vessel.particulars.reducedGrossTonnage}}}
Net Tonnage (NT): {{{vessel.particulars.netTonnage}}}
NRT: {{{vessel.nrt}}}
Summer Deadweight: {{{vessel.summerDwt}}}
Winter Deadweight: {{{vessel.winterDwt}}}
Length between perpendiculars: {{{vessel.particulars.lbp}}}
Type: {{{vessel.type}}}
ESI score: {{{vessel.esiScore}}}
Green Award score: {{{vessel.greenAward}}}

Port call data:
Draft in: {{{portCall.prospects.currentProspects.arrival.details.draftAft}}}
Draft out: {{{portCall.prospects.currentProspects.departureDraftAft}}}
Tugs in: {{{portCall.prospects.currentProspects.arrival.details.tugs}}}
Tugs out: {{{portCall.prospects.currentProspects.departure.details.tugs}}}
Cargoes:
{{#portCall.prospects.currentProspects.terminals}}
{{#cargoes}}
* {{cargo.operation.label}} {{cargo.quantity}} {{cargo.quantityMetricLabel}} of {{cargo.cargo.name}}
{{/cargoes}}
{{/portCall.prospects.currentProspects.terminals}}

Terminal names: 
{{#portCall.prospects.currentProspects.terminals}}
{{#terminal}}
*{{name}}
{{/terminal}}
{{/portCall.prospects.currentProspects.terminals}}

Local arrival time: {{{portCall.ata}}}
Local berthing time: {{{portCall.atb}}}
Local completion of cargo operation time: {{{portCall.atc}}}
Local departure time: {{{portCall.atd}}}

The amount that was invoiced to the vessel was: {{{line.currency}}} {{{line.localAmount}}}. It was for {{{line.line.name}}}.

The invoice image(s) are attached.  
Calculation instructions: {{{lineInstructions}}}

Antwerp Harbour Dues
---------------------

Use values provided through injected variables. Only read the invoice if a required value is missing; if still missing, report it (include value and unit in brackets).
Return a numbered, human-readable breakdown and the final amount. If an invoice amount is available, show the variance and note Pass/Fail at ±2%.

Products
========
1. ZVR_GT – GT-based harbour dues
   Steps:
   1. Map vessel type:
      tanker→tanker, bulkcarrier→bulk, container→containership,
      roro→roro, reefer→reefer, anything else→other.
   2. Service type:
      - shortsea if IsShortsea
      - deepsea if IsLiner
      - otherwise non-liner
   3. Base tariff (€/GT):
      LINER_TARIFFS = { containership: {deepsea:0.3275, shortsea:0.2629},
                        roro:{deepsea:0.2237, shortsea:0.2237},
                        tanker:{deepsea:0.4752, shortsea:0.4752},
                        reefer:{deepsea:0.3621, shortsea:0.3621},
                        bulk:{deepsea:0.3621, shortsea:0.3621},
                        other:{deepsea:0.5322, shortsea:0.5322} }
      NON_LINER_TARIFFS = { containership:0.8072, roro:0.6243,
                            tanker:0.9337, reefer:0.7623,
                            bulk:0.7623, other:0.9337 }
      Base = GT × selected tariff.
   4. Frequency discount by VoyageNumber (liners only):
      deepsea: 53–150→10%, 151–200→20%, ≥201→30%
      shortsea: 27–52→25%, ≥53→50%
      AfterFreq = Base × (1 - discount).
   5. ESI discount by ESI_score and VesselBuiltYear:
      70.1–100→15%; 50.1–70.09→10%;
      31–50.09 and built ≤2010→4%
      AfterESI = AfterFreq × (1 - discount).
   6. Special rate override:
      If SpecialRate = True → AfterESI = GT × 0.2145
      (skip steps 3–5).
   7. Extended stay fee:
      If DaysInPort > 20:
         periods = floor((DaysInPort-20)/20) + 1
         ExtFee = periods × GT × NON_LINER_TARIFFS[mapped_type]
      Else ExtFee = 0
   8. Total = AfterESI + ExtFee

2. Aanlegrecht_Tons – cargo dues
   Steps:
   1. TonsUsed = loaded_tons + discharged_tons
   2. Amount = TonsUsed × unit_rate_eur_per_ton
   3. Total = round(Amount, 2)

Output
------
For each product report:
- Final amount in EUR
- Numbered step-by-step breakdown
- Invoice variance and Pass/Fail if invoice amount given
